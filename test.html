<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­è‹±æ–‡ç¿»è¯‘ç»ƒä¹ å·¥å…·</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .main-content {
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .section {
            background-color: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: #2d3748;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #4b6cb7;
        }
        
        .file-upload-area {
            border: 3px dashed #cbd5e0;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .file-upload-area:hover, .file-upload-area.dragover {
            border-color: #4b6cb7;
            background-color: rgba(75, 108, 183, 0.05);
        }
        
        .upload-icon {
            font-size: 3.5rem;
            color: #4b6cb7;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #4a5568;
        }
        
        .upload-hint {
            color: #718096;
            font-size: 0.95rem;
            margin-top: 10px;
        }
        
        #fileInput {
            display: none;
        }
        
        .upload-btn {
            background: linear-gradient(90deg, #4b6cb7 0%, #3b5998 100%);
            color: white;
            border: none;
            padding: 12px 28px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin-top: 15px;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(75, 108, 183, 0.3);
        }
        
        .file-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #e6f7ff;
            border-radius: 8px;
            border-left: 4px solid #1890ff;
            display: none;
        }
        
        .translation-area {
            display: none;
        }
        
        .current-sentence {
            font-size: 1.8rem;
            color: #2d3748;
            margin-bottom: 25px;
            padding: 20px;
            background-color: #f0f7ff;
            border-radius: 10px;
            border-left: 5px solid #4b6cb7;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .translation-input-container {
            margin-bottom: 30px;
        }
        
        .input-label {
            display: block;
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #4a5568;
            font-weight: 600;
        }
        
        #translationInput {
            width: 100%;
            padding: 18px 20px;
            font-size: 1.2rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s;
            margin-bottom: 10px;
        }
        
        #translationInput:focus {
            outline: none;
            border-color: #4b6cb7;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-btn {
            flex: 1;
            padding: 15px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .submit-btn {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }
        
        .next-btn {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }
        
        .result-area {
            margin-top: 30px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
        
        .correct {
            background-color: #d1fae5;
            border-left: 5px solid #10b981;
        }
        
        .incorrect {
            background-color: #fee2e2;
            border-left: 5px solid #ef4444;
        }
        
        .result-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .user-translation, .correct-translation {
            margin: 8px 0;
            padding: 8px 12px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
        }
        
        .progress-container {
            margin-bottom: 30px;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .progress-bar {
            height: 12px;
            background-color: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4b6cb7 0%, #3b5998 100%);
            width: 0%;
            transition: width 0.5s;
        }
        
        .results-summary {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 15px;
            text-align: center;
        }
        
        .score-display {
            font-size: 3.5rem;
            font-weight: 700;
            color: #4b6cb7;
            margin-bottom: 10px;
        }
        
        .score-text {
            font-size: 1.3rem;
            color: #4a5568;
            margin-bottom: 20px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2d3748;
        }
        
        .stat-label {
            font-size: 1rem;
            color: #718096;
            margin-top: 5px;
        }
        
        .correct-stat .stat-value {
            color: #10b981;
        }
        
        .incorrect-stat .stat-value {
            color: #ef4444;
        }
        
        .restart-btn {
            background: linear-gradient(90deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }
        
        .instructions {
            background-color: #f0f9ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #0ea5e9;
        }
        
        .instructions h3 {
            color: #0369a1;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            color: #475569;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 15px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .section {
                padding: 20px;
            }
            
            .current-sentence {
                font-size: 1.5rem;
                padding: 15px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .stats {
                flex-direction: column;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ä¸­è‹±æ–‡ç¿»è¯‘ç»ƒä¹ å·¥å…·</h1>
            <p class="subtitle">ä¸Šä¼ Excelæ–‡ä»¶ï¼Œç»ƒä¹ ä¸­æ–‡åˆ°è‹±æ–‡ç¿»è¯‘ï¼Œå¹¶ä¸æ ‡å‡†ç­”æ¡ˆå¯¹æ¯”</p>
        </header>
        
        <div class="main-content">
            <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
            <div class="section">
                <h2 class="section-title">
                    <span>ğŸ“</span> ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ Excelæ–‡ä»¶
                </h2>
                <div class="file-upload-area" id="uploadArea">
                    <div class="upload-icon">ğŸ“„</div>
                    <p class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤åŒºåŸŸ</p>
                    <p class="upload-hint">æ–‡ä»¶æ ¼å¼ï¼š.xlsx æˆ– .xlsï¼Œç¬¬ä¸€åˆ—ä¸ºä¸­æ–‡ï¼Œç¬¬äºŒåˆ—ä¸ºè‹±æ–‡ç¿»è¯‘</p>
                    <button class="upload-btn" id="uploadBtn">é€‰æ‹©Excelæ–‡ä»¶</button>
                    <input type="file" id="fileInput" accept=".xlsx,.xls">
                </div>
                <div class="file-info" id="fileInfo"></div>
            </div>
            
            <!-- ç¿»è¯‘ç»ƒä¹ åŒºåŸŸ -->
            <div class="section translation-area" id="translationArea">
                <h2 class="section-title">
                    <span>ğŸ”¤</span> ç¬¬äºŒæ­¥ï¼šç¿»è¯‘ç»ƒä¹ 
                </h2>
                
                <div class="progress-container">
                    <div class="progress-info">
                        <span>è¿›åº¦: <span id="currentIndex">0</span>/<span id="totalSentences">0</span></span>
                        <span>å¾—åˆ†: <span id="score">0</span></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                
                <div class="current-sentence" id="currentSentence">
                    è¯·å…ˆä¸Šä¼ Excelæ–‡ä»¶
                </div>
                
                <div class="translation-input-container">
                    <label class="input-label" for="translationInput">è¯·è¾“å…¥è‹±æ–‡ç¿»è¯‘ï¼š</label>
                    <textarea id="translationInput" rows="3" placeholder="åœ¨æ­¤è¾“å…¥æ‚¨çš„è‹±æ–‡ç¿»è¯‘..."></textarea>
                    
                    <div class="button-group">
                        <button class="action-btn submit-btn" id="submitBtn">æäº¤ç¿»è¯‘</button>
                        <button class="action-btn next-btn" id="nextBtn">ä¸‹ä¸€ä¸ªå¥å­</button>
                    </div>
                </div>
                
                <div class="result-area" id="resultArea">
                    <!-- ç»“æœä¼šåŠ¨æ€æ˜¾ç¤º -->
                </div>
            </div>
            
            <!-- ä½¿ç”¨è¯´æ˜ -->
            <div class="instructions">
                <h3><span>â„¹ï¸</span> ä½¿ç”¨è¯´æ˜</h3>
                <ul>
                    <li>å‡†å¤‡ä¸€ä¸ªExcelæ–‡ä»¶ï¼Œç¬¬ä¸€åˆ—(Aåˆ—)ä¸ºä¸­æ–‡å¥å­ï¼Œç¬¬äºŒåˆ—(Båˆ—)ä¸ºå¯¹åº”çš„è‹±æ–‡ç¿»è¯‘</li>
                    <li>ç‚¹å‡»ä¸Šæ–¹åŒºåŸŸä¸Šä¼ Excelæ–‡ä»¶ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨æå–ä¸­æ–‡å¥å­</li>
                    <li>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ‚¨çš„è‹±æ–‡ç¿»è¯‘ï¼Œç‚¹å‡»"æäº¤ç¿»è¯‘"ä¸æ ‡å‡†ç­”æ¡ˆå¯¹æ¯”</li>
                    <li>ç‚¹å‡»"ä¸‹ä¸€ä¸ªå¥å­"ç»§ç»­ç»ƒä¹ ï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰å¥å­</li>
                    <li>ç³»ç»Ÿä¼šè®°å½•æ‚¨çš„å¾—åˆ†å’Œæ­£ç¡®ç‡ï¼Œå¸®åŠ©æ‚¨è¯„ä¼°ç¿»è¯‘æ°´å¹³</li>
                </ul>
            </div>
            
            <!-- ç»“æœæ€»ç»“ -->
            <div class="results-summary" id="resultsSummary">
                <h2 class="section-title">ç»ƒä¹ å®Œæˆï¼</h2>
                <div class="score-display" id="finalScore">0%</div>
                <p class="score-text" id="scoreText">æ‚¨çš„ç¿»è¯‘å¾—åˆ†</p>
                
                <div class="stats">
                    <div class="stat correct-stat">
                        <div class="stat-value" id="correctCount">0</div>
                        <div class="stat-label">æ­£ç¡®</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">æ€»è®¡</div>
                    </div>
                    <div class="stat incorrect-stat">
                        <div class="stat-value" id="incorrectCount">0</div>
                        <div class="stat-label">é”™è¯¯</div>
                    </div>
                </div>
                
                <button class="restart-btn" id="restartBtn">é‡æ–°å¼€å§‹ç»ƒä¹ </button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let chineseSentences = [];
        let englishAnswers = [];
        let currentIndex = 0;
        let score = 0;
        let results = [];
        
        // DOMå…ƒç´ 
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const fileInfo = document.getElementById('fileInfo');
        const translationArea = document.getElementById('translationArea');
        const currentSentence = document.getElementById('currentSentence');
        const translationInput = document.getElementById('translationInput');
        const submitBtn = document.getElementById('submitBtn');
        const nextBtn = document.getElementById('nextBtn');
        const resultArea = document.getElementById('resultArea');
        const progressFill = document.getElementById('progressFill');
        const currentIndexElement = document.getElementById('currentIndex');
        const totalSentencesElement = document.getElementById('totalSentences');
        const scoreElement = document.getElementById('score');
        const resultsSummary = document.getElementById('resultsSummary');
        const finalScore = document.getElementById('finalScore');
        const correctCount = document.getElementById('correctCount');
        const incorrectCount = document.getElementById('incorrectCount');
        const totalCount = document.getElementById('totalCount');
        const scoreText = document.getElementById('scoreText');
        const restartBtn = document.getElementById('restartBtn');
        const uploadBtn = document.getElementById('uploadBtn');
        
        // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸè§¦å‘æ–‡ä»¶é€‰æ‹©
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadBtn.addEventListener('click', () => fileInput.click());
        
        // æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            if (e.dataTransfer.files.length) {
                const file = e.dataTransfer.files[0];
                if (file.name.match(/\.(xlsx|xls)$/)) {
                    processExcelFile(file);
                } else {
                    alert('è¯·ä¸Šä¼ Excelæ–‡ä»¶ (.xlsx æˆ– .xls æ ¼å¼)');
                }
            }
        });
        
        // æ–‡ä»¶é€‰æ‹©å˜åŒ–
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                processExcelFile(e.target.files[0]);
            }
        });
        
        // å¤„ç†Excelæ–‡ä»¶
        function processExcelFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    
                    // å°†å·¥ä½œè¡¨è½¬æ¢ä¸ºJSON
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                    
                    // æ¸…ç©ºä¹‹å‰çš„æ•°æ®
                    chineseSentences = [];
                    englishAnswers = [];
                    
                    // æå–Aåˆ—å’ŒBåˆ—çš„æ•°æ®
                    jsonData.forEach(row => {
                        if (row[0] && row[0].toString().trim() !== '') {
                            chineseSentences.push(row[0].toString().trim());
                            englishAnswers.push(row[1] ? row[1].toString().trim() : '');
                        }
                    });
                    
                    // æ£€æŸ¥æ˜¯å¦æˆåŠŸæå–æ•°æ®
                    if (chineseSentences.length === 0) {
                        fileInfo.innerHTML = `<strong>é”™è¯¯:</strong> æ²¡æœ‰åœ¨Excelæ–‡ä»¶çš„Aåˆ—æ‰¾åˆ°ä¸­æ–‡å¥å­ã€‚è¯·ç¡®ä¿ç¬¬ä¸€åˆ—æ˜¯ä¸­æ–‡å¥å­ã€‚`;
                        fileInfo.style.display = 'block';
                        fileInfo.style.backgroundColor = '#fee2e2';
                        fileInfo.style.borderLeftColor = '#ef4444';
                        return;
                    }
                    
                    // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
                    fileInfo.innerHTML = `
                        <strong>æ–‡ä»¶åŠ è½½æˆåŠŸï¼</strong><br>
                        æ‰¾åˆ° ${chineseSentences.length} ä¸ªä¸­æ–‡å¥å­<br>
                        æ–‡ä»¶å: ${file.name} (${(file.size / 1024).toFixed(1)} KB)
                    `;
                    fileInfo.style.display = 'block';
                    fileInfo.style.backgroundColor = '#e6f7ff';
                    fileInfo.style.borderLeftColor = '#1890ff';
                    
                    // é‡ç½®ç»ƒä¹ çŠ¶æ€
                    currentIndex = 0;
                    score = 0;
                    results = [];
                    
                    // æ˜¾ç¤ºç¿»è¯‘åŒºåŸŸ
                    translationArea.style.display = 'block';
                    resultArea.style.display = 'none';
                    resultsSummary.style.display = 'none';
                    
                    // æ›´æ–°è¿›åº¦æ˜¾ç¤º
                    updateProgress();
                    
                    // æ˜¾ç¤ºç¬¬ä¸€ä¸ªå¥å­
                    showCurrentSentence();
                    
                } catch (error) {
                    console.error('è§£æExcelæ–‡ä»¶æ—¶å‡ºé”™:', error);
                    fileInfo.innerHTML = `<strong>é”™è¯¯:</strong> è§£æExcelæ–‡ä»¶æ—¶å‡ºé”™ã€‚è¯·ç¡®ä¿æ–‡ä»¶æ ¼å¼æ­£ç¡®ã€‚`;
                    fileInfo.style.display = 'block';
                    fileInfo.style.backgroundColor = '#fee2e2';
                    fileInfo.style.borderLeftColor = '#ef4444';
                }
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        // æ˜¾ç¤ºå½“å‰å¥å­
        function showCurrentSentence() {
            if (currentIndex < chineseSentences.length) {
                currentSentence.textContent = chineseSentences[currentIndex];
                translationInput.value = '';
                resultArea.style.display = 'none';
                
                // æ›´æ–°è¿›åº¦æ˜¾ç¤º
                updateProgress();
                
                // è‡ªåŠ¨èšç„¦åˆ°è¾“å…¥æ¡†
                translationInput.focus();
            } else {
                // æ‰€æœ‰å¥å­å·²å®Œæˆï¼Œæ˜¾ç¤ºç»“æœæ€»ç»“
                showResultsSummary();
            }
        }
        
        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        function updateProgress() {
            currentIndexElement.textContent = currentIndex + 1;
            totalSentencesElement.textContent = chineseSentences.length;
            scoreElement.textContent = score;
            
            const progressPercent = ((currentIndex + 1) / chineseSentences.length) * 100;
            progressFill.style.width = `${Math.min(progressPercent, 100)}%`;
        }
        
        // æäº¤ç¿»è¯‘
        submitBtn.addEventListener('click', () => {
            const userTranslation = translationInput.value.trim();
            
            if (!userTranslation) {
                alert('è¯·è¾“å…¥è‹±æ–‡ç¿»è¯‘');
                return;
            }
            
            const correctAnswer = englishAnswers[currentIndex] || '';
            const isCorrect = compareTranslations(userTranslation, correctAnswer);
            
            // è®°å½•ç»“æœ
            results.push({
                chinese: chineseSentences[currentIndex],
                userTranslation: userTranslation,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            });
            
            // æ›´æ–°åˆ†æ•°
            if (isCorrect) {
                score++;
            }
            
            // æ˜¾ç¤ºç»“æœ
            showResult(isCorrect, userTranslation, correctAnswer);
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            updateProgress();
        });
        
        // ä¸‹ä¸€ä¸ªå¥å­
        nextBtn.addEventListener('click', () => {
            currentIndex++;
            showCurrentSentence();
        });
        
        // æ¯”è¾ƒç¿»è¯‘ï¼ˆç®€å•æ¯”è¾ƒï¼Œå¿½ç•¥å¤§å°å†™å’Œå¤šä½™ç©ºæ ¼ï¼‰
        function compareTranslations(user, correct) {
            if (!correct) return false;
            
            // è½¬æ¢ä¸ºå°å†™å¹¶ç§»é™¤å¤šä½™ç©ºæ ¼
            const userNormalized = user.toLowerCase().replace(/\s+/g, ' ').trim();
            const correctNormalized = correct.toLowerCase().replace(/\s+/g, ' ').trim();
            
            // ç®€å•æ¯”è¾ƒ
            return userNormalized === correctNormalized;
        }
        
        // æ˜¾ç¤ºç»“æœ
        function showResult(isCorrect, userTranslation, correctAnswer) {
            resultArea.className = isCorrect ? 'result-area correct' : 'result-area incorrect';
            
            let resultHTML = '';
            if (isCorrect) {
                resultHTML = `
                    <div class="result-title">âœ… ç¿»è¯‘æ­£ç¡®ï¼</div>
                    <p>æ‚¨çš„ç¿»è¯‘: <span class="user-translation">${userTranslation}</span></p>
                `;
            } else {
                resultHTML = `
                    <div class="result-title">âŒ ç¿»è¯‘ä¸æ­£ç¡®</div>
                    <p>æ‚¨çš„ç¿»è¯‘: <span class="user-translation">${userTranslation}</span></p>
                    <p>å‚è€ƒç­”æ¡ˆ: <span class="correct-translation">${correctAnswer || 'ï¼ˆæ— å‚è€ƒç­”æ¡ˆï¼‰'}</span></p>
                `;
            }
            
            resultArea.innerHTML = resultHTML;
            resultArea.style.display = 'block';
        }
        
        // æ˜¾ç¤ºç»“æœæ€»ç»“
        function showResultsSummary() {
            translationArea.style.display = 'none';
            resultsSummary.style.display = 'block';
            
            const correctCountValue = results.filter(r => r.isCorrect).length;
            const totalCountValue = results.length;
            const incorrectCountValue = totalCountValue - correctCountValue;
            const finalScoreValue = totalCountValue > 0 ? Math.round((correctCountValue / totalCountValue) * 100) : 0;
            
            // æ›´æ–°ç»“æœæ€»ç»“
            correctCount.textContent = correctCountValue;
            incorrectCount.textContent = incorrectCountValue;
            totalCount.textContent = totalCountValue;
            finalScore.textContent = `${finalScoreValue}%`;
            
            // æ ¹æ®åˆ†æ•°æ˜¾ç¤ºä¸åŒè¯„è¯­
            let scoreComment = '';
            if (finalScoreValue >= 90) {
                scoreComment = 'å¤ªæ£’äº†ï¼æ‚¨çš„è‹±æ–‡ç¿»è¯‘æ°´å¹³éå¸¸å‡ºè‰²ï¼';
            } else if (finalScoreValue >= 70) {
                scoreComment = 'ä¸é”™ï¼æ‚¨çš„è‹±æ–‡ç¿»è¯‘æ°´å¹³è‰¯å¥½ï¼Œè¿˜æœ‰æå‡ç©ºé—´ã€‚';
            } else if (finalScoreValue >= 50) {
                scoreComment = 'è¿˜å¯ä»¥ï¼Œç»§ç»­åŠªåŠ›æå‡è‹±æ–‡ç¿»è¯‘æ°´å¹³ã€‚';
            } else {
                scoreComment = 'éœ€è¦å¤šåŠ ç»ƒä¹ ï¼Œç»§ç»­åŠªåŠ›ï¼';
            }
            
            scoreText.textContent = scoreComment;
        }
        
        // é‡æ–°å¼€å§‹
        restartBtn.addEventListener('click', () => {
            currentIndex = 0;
            score = 0;
            results = [];
            
            translationArea.style.display = 'block';
            resultsSummary.style.display = 'none';
            
            showCurrentSentence();
        });
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', () => {
            // æ˜¾ç¤ºç¤ºä¾‹å¥å­
            currentSentence.textContent = "æ¬¢è¿ä½¿ç”¨ä¸­è‹±æ–‡ç¿»è¯‘ç»ƒä¹ å·¥å…·ï¼è¯·ä¸Šä¼ Excelæ–‡ä»¶å¼€å§‹ç»ƒä¹ ã€‚";
        });
    </script>
</body>
</html>