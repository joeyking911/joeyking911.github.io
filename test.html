<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­è‹±æ–‡ç¿»è¯‘ç»ƒä¹ å·¥å…· - æ”¯æŒå¯†ç è§£å¯†</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.4.0/exceljs.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .main-content {
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .section {
            background-color: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: #2d3748;
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 20px;
        }
        
        .mode-btn {
            padding: 12px 25px;
            background-color: #e2e8f0;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .mode-btn.active {
            background: linear-gradient(90deg, #4b6cb7 0%, #3b5998 100%);
            color: white;
        }
        
        .mode-btn:hover:not(.active) {
            background-color: #cbd5e0;
        }
        
        .mode-content {
            display: none;
        }
        
        .mode-content.active {
            display: block;
        }
        
        .file-upload-area {
            border: 3px dashed #cbd5e0;
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .file-upload-area:hover, .file-upload-area.dragover {
            border-color: #4b6cb7;
            background-color: rgba(75, 108, 183, 0.05);
        }
        
        .upload-icon {
            font-size: 3.5rem;
            color: #4b6cb7;
            margin-bottom: 15px;
        }
        
        .upload-text {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #4a5568;
        }
        
        .upload-hint {
            color: #718096;
            font-size: 0.95rem;
            margin-top: 10px;
        }
        
        #fileInput {
            display: none;
        }
        
        .upload-btn {
            background: linear-gradient(90deg, #4b6cb7 0%, #3b5998 100%);
            color: white;
            border: none;
            padding: 12px 28px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin-top: 15px;
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(75, 108, 183, 0.3);
        }
        
        .password-input-area {
            margin-top: 20px;
            padding: 20px;
            background-color: #f0f9ff;
            border-radius: 10px;
            border-left: 4px solid #0ea5e9;
        }
        
        .password-input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .password-label {
            font-weight: 600;
            color: #0369a1;
            font-size: 1rem;
        }
        
        .password-input {
            padding: 12px 15px;
            font-size: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .password-input:focus {
            outline: none;
            border-color: #4b6cb7;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
        }
        
        .password-hint {
            font-size: 0.9rem;
            color: #64748b;
            margin-top: 5px;
        }
        
        .url-input-area {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .url-input-group {
            display: flex;
            gap: 10px;
        }
        
        #serverUrl {
            flex: 1;
            padding: 15px 20px;
            font-size: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        #serverUrl:focus {
            outline: none;
            border-color: #4b6cb7;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
        }
        
        .load-btn {
            background: linear-gradient(90deg, #4b6cb7 0%, #3b5998 100%);
            color: white;
            border: none;
            padding: 0 30px;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .load-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(75, 108, 183, 0.3);
        }
        
        .example-urls {
            margin-top: 10px;
        }
        
        .example-title {
            font-size: 0.9rem;
            color: #4a5568;
            margin-bottom: 8px;
        }
        
        .example-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .example-url {
            padding: 8px 15px;
            background-color: #e6f7ff;
            border-radius: 6px;
            color: #1890ff;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .example-url:hover {
            background-color: #1890ff;
            color: white;
        }
        
        .file-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #e6f7ff;
            border-radius: 8px;
            border-left: 4px solid #1890ff;
            display: none;
        }
        
        .translation-area {
            display: none;
        }
        
        .current-sentence {
            font-size: 1.8rem;
            color: #2d3748;
            margin-bottom: 25px;
            padding: 20px;
            background-color: #f0f7ff;
            border-radius: 10px;
            border-left: 5px solid #4b6cb7;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .translation-input-container {
            margin-bottom: 30px;
        }
        
        .input-label {
            display: block;
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #4a5568;
            font-weight: 600;
        }
        
        #translationInput {
            width: 100%;
            padding: 18px 20px;
            font-size: 1.2rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            transition: all 0.3s;
            margin-bottom: 10px;
        }
        
        #translationInput:focus {
            outline: none;
            border-color: #4b6cb7;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-btn {
            flex: 1;
            padding: 15px;
            font-size: 1.1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .submit-btn {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }
        
        .next-btn {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }
        
        .result-area {
            margin-top: 30px;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
        
        .correct {
            background-color: #d1fae5;
            border-left: 5px solid #10b981;
        }
        
        .incorrect {
            background-color: #fee2e2;
            border-left: 5px solid #ef4444;
        }
        
        .result-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .user-translation, .correct-translation {
            margin: 8px 0;
            padding: 8px 12px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
        }
        
        .progress-container {
            margin-bottom: 30px;
        }
        
        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .progress-bar {
            height: 12px;
            background-color: #e2e8f0;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4b6cb7 0%, #3b5998 100%);
            width: 0%;
            transition: width 0.5s;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #4b6cb7;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results-summary {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 15px;
            text-align: center;
        }
        
        .score-display {
            font-size: 3.5rem;
            font-weight: 700;
            color: #4b6cb7;
            margin-bottom: 10px;
        }
        
        .score-text {
            font-size: 1.3rem;
            color: #4a5568;
            margin-bottom: 20px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2d3748;
        }
        
        .stat-label {
            font-size: 1rem;
            color: #718096;
            margin-top: 5px;
        }
        
        .correct-stat .stat-value {
            color: #10b981;
        }
        
        .incorrect-stat .stat-value {
            color: #ef4444;
        }
        
        .restart-btn {
            background: linear-gradient(90deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }
        
        .instructions {
            background-color: #f0f9ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #0ea5e9;
        }
        
        .instructions h3 {
            color: #0369a1;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
            margin-top: 10px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            color: #475569;
        }
        
        .example-data-btn {
            display: block;
            width: 100%;
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(90deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .example-data-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.3);
        }
        
        .error-message {
            background-color: #fee2e2;
            color: #991b1b;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ef4444;
            margin-top: 20px;
            display: none;
        }
        
        .warning-message {
            background-color: #fef3c7;
            color: #92400e;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #f59e0b;
            margin-top: 20px;
        }
        
        .decryption-options {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .decryption-title {
            font-weight: 600;
            color: #4b5563;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .decryption-options label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            cursor: pointer;
        }
        
        .decryption-options input[type="radio"] {
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 15px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .section {
                padding: 20px;
            }
            
            .current-sentence {
                font-size: 1.5rem;
                padding: 15px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .stats {
                flex-direction: column;
                gap: 20px;
            }
            
            .url-input-group {
                flex-direction: column;
            }
            
            .mode-selector {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ä¸­è‹±æ–‡ç¿»è¯‘ç»ƒä¹ å·¥å…·</h1>
            <p class="subtitle">æ”¯æŒåŠ å¯†Excelæ–‡ä»¶ï¼Œä»æœåŠ¡å™¨æˆ–æœ¬åœ°ä¸Šä¼ æ–‡ä»¶ï¼Œç»ƒä¹ ä¸­æ–‡åˆ°è‹±æ–‡ç¿»è¯‘</p>
        </header>
        
        <div class="main-content">
            <!-- æ•°æ®æºé€‰æ‹©åŒºåŸŸ -->
            <div class="section">
                <h2 class="section-title">
                    <span>ğŸ“</span> ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©æ•°æ®æº
                </h2>
                
                <div class="mode-selector">
                    <button class="mode-btn active" id="uploadModeBtn">ä¸Šä¼ æœ¬åœ°Excelæ–‡ä»¶</button>
                    <button class="mode-btn" id="urlModeBtn">ä»æœåŠ¡å™¨URLåŠ è½½</button>
                </div>
                
                <!-- ä¸Šä¼ æ¨¡å¼ -->
                <div class="mode-content active" id="uploadMode">
                    <div class="file-upload-area" id="uploadArea">
                        <div class="upload-icon">ğŸ“„</div>
                        <p class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤åŒºåŸŸ</p>
                        <p class="upload-hint">æ–‡ä»¶æ ¼å¼ï¼š.xlsx æˆ– .xlsï¼Œç¬¬ä¸€åˆ—ä¸ºä¸­æ–‡ï¼Œç¬¬äºŒåˆ—ä¸ºè‹±æ–‡ç¿»è¯‘</p>
                        <button class="upload-btn" id="uploadBtn">é€‰æ‹©Excelæ–‡ä»¶</button>
                        <input type="file" id="fileInput" accept=".xlsx,.xls,.xlsm">
                    </div>
                    
                    <div class="password-input-area">
                        <div class="password-input-group">
                            <label class="password-label" for="filePassword">Excelæ–‡ä»¶å¯†ç ï¼ˆå¦‚æœæ²¡æœ‰å¯†ç ï¼Œè¯·ç•™ç©ºï¼‰</label>
                            <input type="password" id="filePassword" class="password-input" placeholder="è¾“å…¥Excelæ–‡ä»¶å¯†ç ï¼ˆå¯é€‰ï¼‰">
                            <p class="password-hint">å¦‚æœæ‚¨çš„Excelæ–‡ä»¶æœ‰å¯†ç ä¿æŠ¤ï¼Œè¯·åœ¨æ­¤è¾“å…¥å¯†ç ã€‚å¦‚æœæ²¡æœ‰å¯†ç ï¼Œè¯·ç•™ç©ºã€‚</p>
                        </div>
                    </div>
                    
                    <div class="decryption-options">
                        <div class="decryption-title">
                            <span>ğŸ”</span> è§£å¯†é€‰é¡¹
                        </div>
                        <label>
                            <input type="radio" name="decryptionMethod" value="exceljs" checked>
                            ä½¿ç”¨ExcelJSåº“ï¼ˆæ”¯æŒåŠ å¯†æ–‡ä»¶ï¼‰
                        </label>
                        <label>
                            <input type="radio" name="decryptionMethod" value="xlsx">
                            ä½¿ç”¨XLSXåº“ï¼ˆä»…æ”¯æŒæœªåŠ å¯†æ–‡ä»¶ï¼‰
                        </label>
                    </div>
                </div>
                
                <!-- URLæ¨¡å¼ -->
                <div class="mode-content" id="urlMode">
                    <div class="url-input-area">
                        <p class="upload-text">è¾“å…¥æœåŠ¡å™¨ä¸ŠExcelæ–‡ä»¶çš„URLï¼š</p>
                        <div class="url-input-group">
                            <input type="text" id="serverUrl" placeholder="https://example.com/path/to/your/file.xlsx">
                            <button class="load-btn" id="loadUrlBtn">åŠ è½½æ–‡ä»¶</button>
                        </div>
                        <div class="example-urls">
                            <div class="example-title">ç¤ºä¾‹URLï¼ˆç‚¹å‡»ä½¿ç”¨ï¼‰ï¼š</div>
                            <div class="example-list">
                                <a href="#" class="example-url" data-url="https://docs.google.com/spreadsheets/d/1JkYVz6mCqG8qQjZqQjZqQjZqQjZqQjZqQjZqQjZqQjZqQ/export?format=xlsx">ç¤ºä¾‹1: Google Sheetså¯¼å‡º</a>
                            </div>
                        </div>
                        
                        <div class="password-input-area">
                            <div class="password-input-group">
                                <label class="password-label" for="urlPassword">Excelæ–‡ä»¶å¯†ç ï¼ˆå¦‚æœæ²¡æœ‰å¯†ç ï¼Œè¯·ç•™ç©ºï¼‰</label>
                                <input type="password" id="urlPassword" class="password-input" placeholder="è¾“å…¥Excelæ–‡ä»¶å¯†ç ï¼ˆå¯é€‰ï¼‰">
                                <p class="password-hint">å¦‚æœæ‚¨çš„Excelæ–‡ä»¶æœ‰å¯†ç ä¿æŠ¤ï¼Œè¯·åœ¨æ­¤è¾“å…¥å¯†ç ã€‚å¦‚æœæ²¡æœ‰å¯†ç ï¼Œè¯·ç•™ç©ºã€‚</p>
                            </div>
                        </div>
                        
                        <div class="decryption-options">
                            <div class="decryption-title">
                                <span>ğŸ”</span> è§£å¯†é€‰é¡¹
                            </div>
                            <label>
                                <input type="radio" name="urlDecryptionMethod" value="exceljs" checked>
                                ä½¿ç”¨ExcelJSåº“ï¼ˆæ”¯æŒåŠ å¯†æ–‡ä»¶ï¼‰
                            </label>
                            <label>
                                <input type="radio" name="urlDecryptionMethod" value="xlsx">
                                ä½¿ç”¨XLSXåº“ï¼ˆä»…æ”¯æŒæœªåŠ å¯†æ–‡ä»¶ï¼‰
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- ç¤ºä¾‹æ•°æ® -->
                <button class="example-data-btn" id="exampleDataBtn">ä½¿ç”¨ç¤ºä¾‹æ•°æ®å¼€å§‹ç»ƒä¹ ï¼ˆæ— éœ€æ–‡ä»¶ï¼‰</button>
                
                <div class="file-info" id="fileInfo"></div>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>æ­£åœ¨åŠ è½½Excelæ–‡ä»¶ï¼Œè¯·ç¨å€™...</p>
                </div>
                <div class="error-message" id="errorMessage"></div>
            </div>
            
            <!-- ç¿»è¯‘ç»ƒä¹ åŒºåŸŸ -->
            <div class="section translation-area" id="translationArea">
                <h2 class="section-title">
                    <span>ğŸ”¤</span> ç¬¬äºŒæ­¥ï¼šç¿»è¯‘ç»ƒä¹ 
                </h2>
                
                <div class="progress-container">
                    <div class="progress-info">
                        <span>è¿›åº¦: <span id="currentIndex">0</span>/<span id="totalSentences">0</span></span>
                        <span>å¾—åˆ†: <span id="score">0</span></span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                
                <div class="current-sentence" id="currentSentence">
                    è¯·å…ˆä¸Šä¼ Excelæ–‡ä»¶æˆ–ä»æœåŠ¡å™¨åŠ è½½
                </div>
                
                <div class="translation-input-container">
                    <label class="input-label" for="translationInput">è¯·è¾“å…¥è‹±æ–‡ç¿»è¯‘ï¼š</label>
                    <textarea id="translationInput" rows="3" placeholder="åœ¨æ­¤è¾“å…¥æ‚¨çš„è‹±æ–‡ç¿»è¯‘..."></textarea>
                    
                    <div class="button-group">
                        <button class="action-btn submit-btn" id="submitBtn">æäº¤ç¿»è¯‘</button>
                        <button class="action-btn next-btn" id="nextBtn">ä¸‹ä¸€ä¸ªå¥å­</button>
                    </div>
                </div>
                
                <div class="result-area" id="resultArea">
                    <!-- ç»“æœä¼šåŠ¨æ€æ˜¾ç¤º -->
                </div>
            </div>
            
            <!-- ä½¿ç”¨è¯´æ˜ -->
            <div class="instructions">
                <h3><span>â„¹ï¸</span> ä½¿ç”¨è¯´æ˜</h3>
                <ul>
                    <li><strong>æ¨¡å¼1 - ä¸Šä¼ æœ¬åœ°æ–‡ä»¶</strong>ï¼šä¸Šä¼ æœ¬åœ°Excelæ–‡ä»¶ï¼Œç¬¬ä¸€åˆ—(Aåˆ—)ä¸ºä¸­æ–‡å¥å­ï¼Œç¬¬äºŒåˆ—(Båˆ—)ä¸ºå¯¹åº”çš„è‹±æ–‡ç¿»è¯‘ã€‚å¦‚æœæ–‡ä»¶æœ‰å¯†ç ï¼Œè¯·åœ¨å¯†ç æ¡†ä¸­è¾“å…¥ã€‚</li>
                    <li><strong>æ¨¡å¼2 - ä»æœåŠ¡å™¨åŠ è½½</strong>ï¼šè¾“å…¥æœåŠ¡å™¨ä¸ŠExcelæ–‡ä»¶çš„URLï¼Œæ–‡ä»¶éœ€æ”¯æŒè·¨åŸŸè®¿é—®(CORS)ã€‚å¦‚æœæ–‡ä»¶æœ‰å¯†ç ï¼Œè¯·åœ¨å¯†ç æ¡†ä¸­è¾“å…¥ã€‚</li>
                    <li><strong>è§£å¯†é€‰é¡¹</strong>ï¼šExcelJSåº“æ”¯æŒåŠ å¯†æ–‡ä»¶ï¼ŒXLSXåº“ä»…æ”¯æŒæœªåŠ å¯†æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶åŠ å¯†ï¼Œè¯·é€‰æ‹©ExcelJSåº“ã€‚</li>
                    <li><strong>ç¤ºä¾‹æ•°æ®</strong>ï¼šå¦‚æœæ²¡æœ‰Excelæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ç¤ºä¾‹æ•°æ®ç«‹å³å¼€å§‹ç»ƒä¹ </li>
                    <li>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ‚¨çš„è‹±æ–‡ç¿»è¯‘ï¼Œç‚¹å‡»"æäº¤ç¿»è¯‘"ä¸æ ‡å‡†ç­”æ¡ˆå¯¹æ¯”</li>
                    <li>ç‚¹å‡»"ä¸‹ä¸€ä¸ªå¥å­"ç»§ç»­ç»ƒä¹ ï¼Œç›´åˆ°å®Œæˆæ‰€æœ‰å¥å­</li>
                    <li>ç³»ç»Ÿä¼šè®°å½•æ‚¨çš„å¾—åˆ†å’Œæ­£ç¡®ç‡ï¼Œå¸®åŠ©æ‚¨è¯„ä¼°ç¿»è¯‘æ°´å¹³</li>
                </ul>
            </div>
            
            <!-- ç»“æœæ€»ç»“ -->
            <div class="results-summary" id="resultsSummary">
                <h2 class="section-title">ç»ƒä¹ å®Œæˆï¼</h2>
                <div class="score-display" id="finalScore">0%</div>
                <p class="score-text" id="scoreText">æ‚¨çš„ç¿»è¯‘å¾—åˆ†</p>
                
                <div class="stats">
                    <div class="stat correct-stat">
                        <div class="stat-value" id="correctCount">0</div>
                        <div class="stat-label">æ­£ç¡®</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">æ€»è®¡</div>
                    </div>
                    <div class="stat incorrect-stat">
                        <div class="stat-value" id="incorrectCount">0</div>
                        <div class="stat-label">é”™è¯¯</div>
                    </div>
                </div>
                
                <button class="restart-btn" id="restartBtn">é‡æ–°å¼€å§‹ç»ƒä¹ </button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let chineseSentences = [];
        let englishAnswers = [];
        let currentIndex = 0;
        let score = 0;
        let results = [];
        let dataSource = ''; // è®°å½•æ•°æ®æ¥æº
        
        // DOMå…ƒç´ 
        const uploadModeBtn = document.getElementById('uploadModeBtn');
        const urlModeBtn = document.getElementById('urlModeBtn');
        const uploadMode = document.getElementById('uploadMode');
        const urlMode = document.getElementById('urlMode');
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const filePasswordInput = document.getElementById('filePassword');
        const urlPasswordInput = document.getElementById('urlPassword');
        const serverUrlInput = document.getElementById('serverUrl');
        const loadUrlBtn = document.getElementById('loadUrlBtn');
        const exampleUrls = document.querySelectorAll('.example-url');
        const exampleDataBtn = document.getElementById('exampleDataBtn');
        const fileInfo = document.getElementById('fileInfo');
        const loading = document.getElementById('loading');
        const errorMessage = document.getElementById('errorMessage');
        const translationArea = document.getElementById('translationArea');
        const currentSentence = document.getElementById('currentSentence');
        const translationInput = document.getElementById('translationInput');
        const submitBtn = document.getElementById('submitBtn');
        const nextBtn = document.getElementById('nextBtn');
        const resultArea = document.getElementById('resultArea');
        const progressFill = document.getElementById('progressFill');
        const currentIndexElement = document.getElementById('currentIndex');
        const totalSentencesElement = document.getElementById('totalSentences');
        const scoreElement = document.getElementById('score');
        const resultsSummary = document.getElementById('resultsSummary');
        const finalScore = document.getElementById('finalScore');
        const correctCount = document.getElementById('correctCount');
        const incorrectCount = document.getElementById('incorrectCount');
        const totalCount = document.getElementById('totalCount');
        const scoreText = document.getElementById('scoreText');
        const restartBtn = document.getElementById('restartBtn');
        const uploadBtn = document.getElementById('uploadBtn');
        
        // æ¨¡å¼åˆ‡æ¢
        uploadModeBtn.addEventListener('click', () => {
            uploadModeBtn.classList.add('active');
            urlModeBtn.classList.remove('active');
            uploadMode.classList.add('active');
            urlMode.classList.remove('active');
        });
        
        urlModeBtn.addEventListener('click', () => {
            urlModeBtn.classList.add('active');
            uploadModeBtn.classList.remove('active');
            urlMode.classList.add('active');
            uploadMode.classList.remove('active');
        });
        
        // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸè§¦å‘æ–‡ä»¶é€‰æ‹©
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadBtn.addEventListener('click', () => fileInput.click());
        
        // æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            if (e.dataTransfer.files.length) {
                const file = e.dataTransfer.files[0];
                if (file.name.match(/\.(xlsx|xls|xlsm)$/)) {
                    dataSource = `ä¸Šä¼ æ–‡ä»¶: ${file.name}`;
                    processExcelFile(file);
                } else {
                    showError('è¯·ä¸Šä¼ Excelæ–‡ä»¶ (.xlsx, .xls æˆ– .xlsm æ ¼å¼)');
                }
            }
        });
        
        // æ–‡ä»¶é€‰æ‹©å˜åŒ–
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                const file = e.target.files[0];
                dataSource = `ä¸Šä¼ æ–‡ä»¶: ${file.name}`;
                processExcelFile(file);
            }
        });
        
        // ä»URLåŠ è½½Excelæ–‡ä»¶
        loadUrlBtn.addEventListener('click', () => {
            const url = serverUrlInput.value.trim();
            if (!url) {
                showError('è¯·è¾“å…¥Excelæ–‡ä»¶çš„URL');
                return;
            }
            
            if (!url.match(/\.(xlsx|xls|xlsm)$/)) {
                showError('URLå¿…é¡»æŒ‡å‘Excelæ–‡ä»¶ (.xlsx, .xls æˆ– .xlsm æ ¼å¼)');
                return;
            }
            
            dataSource = `æœåŠ¡å™¨æ–‡ä»¶: ${url}`;
            loadExcelFromUrl(url);
        });
        
        // ç¤ºä¾‹URLç‚¹å‡»
        exampleUrls.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const url = link.getAttribute('data-url');
                serverUrlInput.value = url;
                dataSource = `ç¤ºä¾‹æ–‡ä»¶: ${url}`;
            });
        });
        
        // ä½¿ç”¨ç¤ºä¾‹æ•°æ®
        exampleDataBtn.addEventListener('click', () => {
            dataSource = 'ç¤ºä¾‹æ•°æ®';
            useExampleData();
        });
        
        // ä»URLåŠ è½½Excelæ–‡ä»¶
        async function loadExcelFromUrl(url) {
            showLoading(true);
            hideError();
            fileInfo.style.display = 'none';
            
            try {
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTPé”™è¯¯: ${response.status} ${response.statusText}`);
                }
                
                const arrayBuffer = await response.arrayBuffer();
                const password = urlPasswordInput.value;
                const decryptionMethod = document.querySelector('input[name="urlDecryptionMethod"]:checked').value;
                
                await processExcelData(arrayBuffer, url, password, decryptionMethod);
            } catch (error) {
                console.error('åŠ è½½Excelæ–‡ä»¶æ—¶å‡ºé”™:', error);
                showLoading(false);
                showError(`
                    <strong>åŠ è½½å¤±è´¥:</strong> ${error.message}<br>
                    å¯èƒ½çš„åŸå› ï¼š<br>
                    1. æ–‡ä»¶URLä¸æ­£ç¡®<br>
                    2. æœåŠ¡å™¨æœªå¯ç”¨CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰<br>
                    3. ç½‘ç»œè¿æ¥é—®é¢˜<br>
                    4. æ–‡ä»¶åŠ å¯†ä¸”å¯†ç é”™è¯¯<br>
                    å»ºè®®ï¼šå°è¯•ä½¿ç”¨ç¤ºä¾‹æ•°æ®ï¼Œæˆ–ä¸‹è½½æ–‡ä»¶åä½¿ç”¨ä¸Šä¼ åŠŸèƒ½
                `);
            }
        }
        
        // å¤„ç†Excelæ–‡ä»¶ï¼ˆä¸Šä¼ æ¨¡å¼ï¼‰
        function processExcelFile(file) {
            showLoading(true);
            hideError();
            fileInfo.style.display = 'none';
            
            const reader = new FileReader();
            
            reader.onload = async function(e) {
                try {
                    const password = filePasswordInput.value;
                    const decryptionMethod = document.querySelector('input[name="decryptionMethod"]:checked').value;
                    await processExcelData(e.target.result, file.name, password, decryptionMethod);
                } catch (error) {
                    showLoading(false);
                    showError(`å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™: ${error.message}`);
                }
            };
            
            reader.onerror = function() {
                showLoading(false);
                showError('è¯»å–æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å®Œæ•´ä¸”å¯è®¿é—®ã€‚');
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        // å¤„ç†Excelæ•°æ®ï¼ˆé€šç”¨å‡½æ•°ï¼‰
        async function processExcelData(data, sourceName, password, decryptionMethod) {
            try {
                // æ¸…ç©ºä¹‹å‰çš„æ•°æ®
                chineseSentences = [];
                englishAnswers = [];
                
                if (decryptionMethod === 'exceljs' && typeof ExcelJS !== 'undefined') {
                    // ä½¿ç”¨ExcelJSåº“å¤„ç†ï¼ˆæ”¯æŒåŠ å¯†æ–‡ä»¶ï¼‰
                    await processWithExcelJS(data, password);
                } else {
                    // ä½¿ç”¨XLSXåº“å¤„ç†ï¼ˆä»…æ”¯æŒæœªåŠ å¯†æ–‡ä»¶ï¼‰
                    processWithXLSX(data);
                }
                
                // æ£€æŸ¥æ˜¯å¦æˆåŠŸæå–æ•°æ®
                if (chineseSentences.length === 0) {
                    showLoading(false);
                    showError('æ²¡æœ‰åœ¨Excelæ–‡ä»¶çš„Aåˆ—æ‰¾åˆ°ä¸­æ–‡å¥å­ã€‚è¯·ç¡®ä¿ç¬¬ä¸€åˆ—æ˜¯ä¸­æ–‡å¥å­ã€‚');
                    return;
                }
                
                // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
                showLoading(false);
                fileInfo.innerHTML = `
                    <strong>æ•°æ®åŠ è½½æˆåŠŸï¼</strong><br>
                    æ¥æº: ${dataSource}<br>
                    æ‰¾åˆ° ${chineseSentences.length} ä¸ªä¸­æ–‡å¥å­<br>
                    è§£å¯†æ–¹æ³•: ${decryptionMethod === 'exceljs' ? 'ExcelJSï¼ˆæ”¯æŒåŠ å¯†ï¼‰' : 'XLSXï¼ˆä»…æœªåŠ å¯†ï¼‰'}
                `;
                fileInfo.style.display = 'block';
                fileInfo.style.backgroundColor = '#e6f7ff';
                fileInfo.style.borderLeftColor = '#1890ff';
                
                // é‡ç½®ç»ƒä¹ çŠ¶æ€
                currentIndex = 0;
                score = 0;
                results = [];
                
                // æ˜¾ç¤ºç¿»è¯‘åŒºåŸŸ
                translationArea.style.display = 'block';
                resultArea.style.display = 'none';
                resultsSummary.style.display = 'none';
                
                // æ›´æ–°è¿›åº¦æ˜¾ç¤º
                updateProgress();
                
                // æ˜¾ç¤ºç¬¬ä¸€ä¸ªå¥å­
                showCurrentSentence();
                
            } catch (error) {
                console.error('è§£æExcelæ–‡ä»¶æ—¶å‡ºé”™:', error);
                showLoading(false);
                
                let errorMsg = `
                    <strong>è§£æExcelæ–‡ä»¶æ—¶å‡ºé”™:</strong> ${error.message}<br>
                    è¯·ç¡®ä¿æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼Œä¸”åŒ…å«Aåˆ—ï¼ˆä¸­æ–‡ï¼‰å’ŒBåˆ—ï¼ˆè‹±æ–‡ï¼‰æ•°æ®ã€‚
                `;
                
                if (error.message.includes('password') || error.message.includes('è§£å¯†')) {
                    errorMsg += '<br><br><strong>æç¤ºï¼š</strong> æ–‡ä»¶å¯èƒ½éœ€è¦å¯†ç ã€‚è¯·æ£€æŸ¥ï¼š<br>' +
                               '1. æ˜¯å¦è¾“å…¥äº†æ­£ç¡®çš„å¯†ç <br>' +
                               '2. æ˜¯å¦é€‰æ‹©äº†æ­£ç¡®çš„è§£å¯†æ–¹æ³•ï¼ˆåŠ å¯†æ–‡ä»¶éœ€è¦ä½¿ç”¨ExcelJSåº“ï¼‰<br>' +
                               '3. å¦‚æœæ–‡ä»¶æ²¡æœ‰å¯†ç ï¼Œè¯·å°è¯•æ¸…ç©ºå¯†ç æ¡†å¹¶é€‰æ‹©XLSXåº“';
                }
                
                showError(errorMsg);
            }
        }
        
        // ä½¿ç”¨ExcelJSåº“å¤„ç†Excelæ–‡ä»¶ï¼ˆæ”¯æŒåŠ å¯†ï¼‰
        async function processWithExcelJS(data, password) {
            const workbook = new ExcelJS.Workbook();
            
            // å¦‚æœæä¾›äº†å¯†ç ï¼Œä½¿ç”¨å¯†ç è§£å¯†
            if (password) {
                await workbook.xlsx.load(data, { password: password });
            } else {
                await workbook.xlsx.load(data);
            }
            
            // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
            const worksheet = workbook.worksheets[0];
            
            // éå†è¡Œæå–æ•°æ®
            worksheet.eachRow((row, rowNumber) => {
                // è·³è¿‡å¯èƒ½çš„æ ‡é¢˜è¡Œï¼ˆç¬¬ä¸€è¡Œï¼‰
                if (rowNumber === 1 && row.getCell(1).value && 
                    (row.getCell(1).value.toString().includes('ä¸­æ–‡') || 
                     row.getCell(1).value.toString().includes('Chinese'))) {
                    return; // è·³è¿‡æ ‡é¢˜è¡Œ
                }
                
                const chinese = row.getCell(1).value;
                const english = row.getCell(2).value;
                
                if (chinese && chinese.toString().trim() !== '') {
                    chineseSentences.push(chinese.toString().trim());
                    englishAnswers.push(english ? english.toString().trim() : '');
                }
            });
        }
        
        // ä½¿ç”¨XLSXåº“å¤„ç†Excelæ–‡ä»¶ï¼ˆä¸æ”¯æŒåŠ å¯†ï¼‰
        function processWithXLSX(data) {
            const workbook = XLSX.read(data, { type: 'array' });
            
            // è·å–ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            
            // å°†å·¥ä½œè¡¨è½¬æ¢ä¸ºJSON
            const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
            
            // æå–Aåˆ—å’ŒBåˆ—çš„æ•°æ®
            jsonData.forEach((row, index) => {
                // è·³è¿‡å¯èƒ½çš„æ ‡é¢˜è¡Œ
                if (index === 0 && row[0] && 
                    (row[0].toString().includes('ä¸­æ–‡') || 
                     row[0].toString().includes('Chinese'))) {
                    return;
                }
                
                if (row[0] && row[0].toString().trim() !== '') {
                    chineseSentences.push(row[0].toString().trim());
                    englishAnswers.push(row[1] ? row[1].toString().trim() : '');
                }
            });
        }
        
        // ä½¿ç”¨ç¤ºä¾‹æ•°æ®
        function useExampleData() {
            // ç¤ºä¾‹æ•°æ®
            chineseSentences = [
                "ä½ å¥½ï¼Œä¸–ç•Œï¼",
                "ä»Šå¤©çš„å¤©æ°”éå¸¸å¥½ã€‚",
                "æˆ‘å–œæ¬¢å­¦ä¹ æ–°çš„è¯­è¨€ã€‚",
                "äººå·¥æ™ºèƒ½æ­£åœ¨æ”¹å˜ä¸–ç•Œã€‚",
                "å¥¹æ¯å¤©æ—©ä¸Šéƒ½å»å…¬å›­è·‘æ­¥ã€‚",
                "è¿™ä¸ªé¡¹ç›®å°†åœ¨ä¸‹ä¸ªæœˆå®Œæˆã€‚",
                "è¯·æŠŠç›é€’ç»™æˆ‘ã€‚",
                "ä»–æ˜¯ä¸€ä½éå¸¸æœ‰ç»éªŒçš„å·¥ç¨‹å¸ˆã€‚",
                "æˆ‘ä»¬è®¡åˆ’æ˜å¹´å»æ—¥æœ¬æ—…è¡Œã€‚",
                "è¿™ä¸ªé—®é¢˜æ¯”æˆ‘æƒ³è±¡çš„è¦å¤æ‚ã€‚"
            ];
            
            englishAnswers = [
                "Hello, world!",
                "The weather is very nice today.",
                "I like learning new languages.",
                "Artificial intelligence is changing the world.",
                "She goes running in the park every morning.",
                "This project will be completed next month.",
                "Please pass me the salt.",
                "He is a very experienced engineer.",
                "We plan to travel to Japan next year.",
                "This problem is more complicated than I thought."
            ];
            
            // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
            fileInfo.innerHTML = `
                <strong>ç¤ºä¾‹æ•°æ®åŠ è½½æˆåŠŸï¼</strong><br>
                æ¥æº: ${dataSource}<br>
                æ‰¾åˆ° ${chineseSentences.length} ä¸ªä¸­æ–‡å¥å­<br>
                æç¤º: è¿™æ˜¯ç¤ºä¾‹æ•°æ®ã€‚è¦ä½¿ç”¨è‡ªå·±çš„æ•°æ®ï¼Œè¯·ä¸Šä¼ Excelæ–‡ä»¶æˆ–è¾“å…¥URLã€‚
            `;
            fileInfo.style.display = 'block';
            fileInfo.style.backgroundColor = '#e6f7ff';
            fileInfo.style.borderLeftColor = '#1890ff';
            
            // é‡ç½®ç»ƒä¹ çŠ¶æ€
            currentIndex = 0;
            score = 0;
            results = [];
            
            // æ˜¾ç¤ºç¿»è¯‘åŒºåŸŸ
            translationArea.style.display = 'block';
            resultArea.style.display = 'none';
            resultsSummary.style.display = 'none';
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            updateProgress();
            
            // æ˜¾ç¤ºç¬¬ä¸€ä¸ªå¥å­
            showCurrentSentence();
        }
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading(isLoading) {
            loading.style.display = isLoading ? 'block' : 'none';
        }
        
        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            errorMessage.innerHTML = message;
            errorMessage.style.display = 'block';
        }
        
        // éšè—é”™è¯¯ä¿¡æ¯
        function hideError() {
            errorMessage.style.display = 'none';
        }
        
        // æ˜¾ç¤ºå½“å‰å¥å­
        function showCurrentSentence() {
            if (currentIndex < chineseSentences.length) {
                currentSentence.textContent = chineseSentences[currentIndex];
                translationInput.value = '';
                resultArea.style.display = 'none';
                
                // æ›´æ–°è¿›åº¦æ˜¾ç¤º
                updateProgress();
                
                // è‡ªåŠ¨èšç„¦åˆ°è¾“å…¥æ¡†
                translationInput.focus();
            } else {
                // æ‰€æœ‰å¥å­å·²å®Œæˆï¼Œæ˜¾ç¤ºç»“æœæ€»ç»“
                showResultsSummary();
            }
        }
        
        // æ›´æ–°è¿›åº¦æ˜¾ç¤º
        function updateProgress() {
            currentIndexElement.textContent = currentIndex + 1;
            totalSentencesElement.textContent = chineseSentences.length;
            scoreElement.textContent = score;
            
            const progressPercent = ((currentIndex + 1) / chineseSentences.length) * 100;
            progressFill.style.width = `${Math.min(progressPercent, 100)}%`;
        }
        
        // æäº¤ç¿»è¯‘
        submitBtn.addEventListener('click', () => {
            const userTranslation = translationInput.value.trim();
            
            if (!userTranslation) {
                alert('è¯·è¾“å…¥è‹±æ–‡ç¿»è¯‘');
                return;
            }
            
            const correctAnswer = englishAnswers[currentIndex] || '';
            const isCorrect = compareTranslations(userTranslation, correctAnswer);
            
            // è®°å½•ç»“æœ
            results.push({
                chinese: chineseSentences[currentIndex],
                userTranslation: userTranslation,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            });
            
            // æ›´æ–°åˆ†æ•°
            if (isCorrect) {
                score++;
            }
            
            // æ˜¾ç¤ºç»“æœ
            showResult(isCorrect, userTranslation, correctAnswer);
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            updateProgress();
        });
        
        // ä¸‹ä¸€ä¸ªå¥å­
        nextBtn.addEventListener('click', () => {
            currentIndex++;
            showCurrentSentence();
        });
        
        // æ¯”è¾ƒç¿»è¯‘ï¼ˆç®€å•æ¯”è¾ƒï¼Œå¿½ç•¥å¤§å°å†™å’Œå¤šä½™ç©ºæ ¼ï¼‰
        function compareTranslations(user, correct) {
            if (!correct) return false;
            
            // è½¬æ¢ä¸ºå°å†™å¹¶ç§»é™¤å¤šä½™ç©ºæ ¼
            const userNormalized = user.toLowerCase().replace(/\s+/g, ' ').trim();
            const correctNormalized = correct.toLowerCase().replace(/\s+/g, ' ').trim();
            
            // ç®€å•æ¯”è¾ƒ
            return userNormalized === correctNormalized;
        }
        
        // æ˜¾ç¤ºç»“æœ
        function showResult(isCorrect, userTranslation, correctAnswer) {
            resultArea.className = isCorrect ? 'result-area correct' : 'result-area incorrect';
            
            let resultHTML = '';
            if (isCorrect) {
                resultHTML = `
                    <div class="result-title">âœ… ç¿»è¯‘æ­£ç¡®ï¼</div>
                    <p>æ‚¨çš„ç¿»è¯‘: <span class="user-translation">${userTranslation}</span></p>
                `;
            } else {
                resultHTML = `
                    <div class="result-title">âŒ ç¿»è¯‘ä¸æ­£ç¡®</div>
                    <p>æ‚¨çš„ç¿»è¯‘: <span class="user-translation">${userTranslation}</span></p>
                    <p>å‚è€ƒç­”æ¡ˆ: <span class="correct-translation">${correctAnswer || 'ï¼ˆæ— å‚è€ƒç­”æ¡ˆï¼‰'}</span></p>
                `;
            }
            
            resultArea.innerHTML = resultHTML;
            resultArea.style.display = 'block';
        }
        
        // æ˜¾ç¤ºç»“æœæ€»ç»“
        function showResultsSummary() {
            translationArea.style.display = 'none';
            resultsSummary.style.display = 'block';
            
            const correctCountValue = results.filter(r => r.isCorrect).length;
            const totalCountValue = results.length;
            const incorrectCountValue = totalCountValue - correctCountValue;
            const finalScoreValue = totalCountValue > 0 ? Math.round((correctCountValue / totalCountValue) * 100) : 0;
            
            // æ›´æ–°ç»“æœæ€»ç»“
            correctCount.textContent = correctCountValue;
            incorrectCount.textContent = incorrectCountValue;
            totalCount.textContent = totalCountValue;
            finalScore.textContent = `${finalScoreValue}%`;
            
            // æ ¹æ®åˆ†æ•°æ˜¾ç¤ºä¸åŒè¯„è¯­
            let scoreComment = '';
            if (finalScoreValue >= 90) {
                scoreComment = 'å¤ªæ£’äº†ï¼æ‚¨çš„è‹±æ–‡ç¿»è¯‘æ°´å¹³éå¸¸å‡ºè‰²ï¼';
            } else if (finalScoreValue >= 70) {
                scoreComment = 'ä¸é”™ï¼æ‚¨çš„è‹±æ–‡ç¿»è¯‘æ°´å¹³è‰¯å¥½ï¼Œè¿˜æœ‰æå‡ç©ºé—´ã€‚';
            } else if (finalScoreValue >= 50) {
                scoreComment = 'è¿˜å¯ä»¥ï¼Œç»§ç»­åŠªåŠ›æå‡è‹±æ–‡ç¿»è¯‘æ°´å¹³ã€‚';
            } else {
                scoreComment = 'éœ€è¦å¤šåŠ ç»ƒä¹ ï¼Œç»§ç»­åŠªåŠ›ï¼';
            }
            
            scoreText.textContent = scoreComment;
        }
        
        // é‡æ–°å¼€å§‹
        restartBtn.addEventListener('click', () => {
            currentIndex = 0;
            score = 0;
            results = [];
            
            translationArea.style.display = 'block';
            resultsSummary.style.display = 'none';
            
            showCurrentSentence();
        });
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', () => {
            // æ˜¾ç¤ºç¤ºä¾‹å¥å­
            currentSentence.textContent = "æ¬¢è¿ä½¿ç”¨ä¸­è‹±æ–‡ç¿»è¯‘ç»ƒä¹ å·¥å…·ï¼è¯·é€‰æ‹©æ•°æ®æºå¼€å§‹ç»ƒä¹ ã€‚";
            
            // è®¾ç½®é»˜è®¤URLç¤ºä¾‹
            serverUrlInput.value = "https://joeyking911.github.io/test.xlsx";
            
            // æ£€æŸ¥ExcelJSåº“æ˜¯å¦åŠ è½½æˆåŠŸ
            if (typeof ExcelJS === 'undefined') {
                console.warn('ExcelJSåº“åŠ è½½å¤±è´¥ï¼ŒåŠ å¯†æ–‡ä»¶åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨');
                const warning = document.createElement('div');
                warning.className = 'warning-message';
                warning.innerHTML = `
                    <strong>æ³¨æ„ï¼š</strong> ExcelJSåº“åŠ è½½ä¸­ï¼ŒåŠ å¯†æ–‡ä»¶åŠŸèƒ½å¯èƒ½å—é™ã€‚
                    å¦‚æœé‡åˆ°åŠ å¯†æ–‡ä»¶è¯»å–é—®é¢˜ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚
                `;
                document.querySelector('.main-content').insertBefore(warning, document.querySelector('.section'));
            }
        });
    </script>
</body>
</html>
